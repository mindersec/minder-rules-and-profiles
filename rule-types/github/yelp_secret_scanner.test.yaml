---
version: v1
tests:
  - name: should pass when all requirements are met
    def: {}
    params: {}
    entity:
      type: repository
      entity:
        name: test-repo
    git:
      repo_base: valid-config
    expect: pass

  - name: should fail when baseline file is missing
    def: {}
    params: {}
    entity:
      type: repository
      entity:
        name: test-repo
    git:
      repo_base: missing-baseline
    expect: fail

  - name: should fail when exclusion patterns are missing
    def: {}
    params: {}
    entity:
      type: repository
      entity:
        name: test-repo
    git:
      repo_base: missing-patterns
    expect: fail

  - name: should fail when workflow is missing secret scanner
    def: {}
    params: {}
    entity:
      type: repository
      entity:
        name: test-repo
    git:
      repo_base: missing-scanner
    expect: fail 